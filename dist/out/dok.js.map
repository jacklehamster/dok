{"version":3,"sources":["../../out/dok.js"],"names":["_typeof","Symbol","iterator","obj","constructor","prototype","define","fixPath","regex","exec","location","pathname","window","history","pushState","search","hash","changeScene","scene","htmlFile","Utils","destroyEverything","replace","handleError","error","soft","Array","isArray","array","i","length","push","console","apply","lastError","Error","combineMethods","firstMethod","secondMethod","expectParams","args","assert","arguments","type","split","indexOf","checkParams","condition","message","cleanUp","setupExit","document","onbeforeunload","onDestroy","callback","definePrototypes","String","trim","requestAnimationFrame","setupRequestAnimationFrame","Float32Array","fill","fill_compat","Uint32Array","getFrame","index","Number","value","start","end","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","requestAnimationFrame_compat","timeout","time","setTimeout","timeoutCallback","clearTimeout","dt","Date","now","loadAsyncHelper","src","result","binary","method","data","loadAsync","undefined","xhr","XMLHttpRequest","overrideMimeType","open","addEventListener","e","readyState","status","responseText","send","Roundabout","x","y","left","right","top","bottom","direction","point","reset","current","next","addLinkToHeadTag","rel","href","link","createElement","setAttribute","head","appendChild","getTitle","title","coreLoops","frame","fps","period","Math","floor","nextTime","lastCount","frameCount","loop","Loop","addLoop","beginLoop","removeLoop","splice","loopTime","performance","Object","defineProperty","enumerable","configurable","get","set","gifWorkerCallbacks","GifWorker","onmessage","frameInfo","cData","header","id","plasterPixels","postMessage","buffer","img","gce","transparency","transparencyGiven","transparencyIndex","disposalMethod","ct","lctFlag","lct","gct","pixels","forEach","pixel","code","toString","substring","lastIndexOf","blob","Blob","gifWorker","Worker","URL","createObjectURL","initializeGifWorker","sendToGifWorker","require","md5","random","terminate","gifs","isGif","block","slice","toLowerCase","getGif","createGif","renderTime","currentFrame","maxFrameCompleted","gifInfo","framesProcessed","frameInfos","canvases","callbacks","processNextFrame","canvas","style","position","width","height","ctx","getContext","webkitImageSmoothingEnabled","imageSmoothingEnabled","msImageSmoothingEnabled","drawImage","getImageData","self","processNext","bind","putImageData","ready","hdr","_hdr","_gce","cycleTime","currentIndex","delayTime","_img","totalAnimationTime","min","eof","content","parseGIF","Stream","GifHandler","THREE","camera","camera2d","OrthographicCamera","innerWidth","innerHeight","camera3d","PerspectiveCamera","cameraQuaternionData","forwardMovement","Vector3","version","lastQuat","Quaternion","tempQuat","tempQuatArray","upVector","groundQuat","setFromAxisAngle","PI","getCamera","nop","setCamera3d","copyCamera","updateQuaternionData","quaternion","toArray","applyQuaternion","getCameraQuaternionData","equals","copy","initCameras","isCamera3d","from","to","getCameraPosition","setCameraPosition","is3d","fromArray","updateProjectionMatrix","shadowQuatArray","angle","atan2","z","multiply","quaternionArrays","quaternions","groundQuaternionArray","southQuaternionArray","northQuaternionArray","westQuaternionArray","eastQuaternionArray","ceilingQuaternionArray","checkWindowSize","gameWidth","gameHeight","aspect","Camera","ObjectPool","classObject","pool","create","recycleAll","pool_create","pool_recycleAll","SpriteObject","size","quaternionArray","init","light","hasQuaternionArray","offset","MAX_TEXTURES","SPRITE_SHEET_SIZE","CHUNKSIZES","chunks","doesFit","tex","xi","yi","findSlot","chunkWidth","ceil","chunkHeight","fillSlot","getSlot","slot","Packer","imageQueue","loadLimit","loading","loadingBar","visualProgress","onLoadCallback","loaded","loadTotal","setOnLoad","onLoad","body","removeChild","getLoadingBar","loadImage","url","image","Image","onload","event","call","checkLoad","crossOrigin","loadFile","getLoadingProgress","refreshLoadingBar","actualProgress","max","fillRect","round","backgroundColor","border","fillStyle","Loader","cuts","cutArray","cutCount","textures","slots","planeGeometry","PlaneBufferGeometry","getCanvas","canCreate","parseInt","pop","Texture","magFilter","NearestFilter","minFilter","LinearMipMapLinearFilter","updateTextureEvent","initCanvas","context","customEvent","detail","evt","createEvent","initCustomEvent","fetchCanvas","urlpipe","join","subpipe","processString","subCanvas","getAttribute","processCanvas","currentTarget","dispatchEvent","isNaN","gif","drawGif","naturalWidth","naturalHeight","outputCanvas","outputCtx","splits","every","num","map","o","drawWidth","drawHeight","scale","abs","sign","translate","restore","borderWidth","parseFloat","beginPath","rect","stroke","font","fillText","moveTo","lineTo","getCut","cut","animated","getCutByURL","baseUrl","uv","updateSpritesheetEvent","uvX","uvY","uvW","uvH","uvOrder","attributes","cutcut","u","preLoad","images","root","SpriteSheet","spritesheet","prop","hasOwnProperty","log","needsUpdate","dispose","getTextures","buckets","counts","SIZE","indexFunction","initArray","getMinMax","firstIndex","minNum","maxNum","previousNum","inOrder","identity","a","turboSort","func","turboSortHelper","quickSort","quickSortHelper","compareIndex","b","arrayInfo","range","voyager","bucketId","newSpot","swap","temp","arr","compare","len","pivot","partitionIndex","partition","pivotValue","fragmentShader","vertexShader","vertexShaderCommon","Shader","pointCount","count","indices","spriteRenderers","uniforms","indexProcessor","SpriteRenderer","imageOrder","imageCount","mesh","createMesh","curvature","display","spriteObject","visible","SpriteImage","j","indexArray","quat","quatDirty","spotArray","positionDirty","vertices","v","verticesDirty","uvDirty","texDirty","lightDirty","destroy","destroySprite","render","updateGraphics","clear","Uint16Array","zIndex","spriteRenderer","geometry","BufferGeometry","addAttribute","BufferAttribute","Mesh","MeshBasicMaterial","material","ShaderMaterial","texture","vCam","transparent","depthWrite","depthTest","frustumCulled","sortImages","distanceToManhattan","setIndexProcessor","fun","previousAttribute","copyArray","setDynamic","spot","geo_quaternion","geo_spot","geo_pos","geo_tex","geo_light","geo_uv","geo_index","quatChanged","positionChanged","texChanged","verticesChanged","uvChanged","lightChanged","drawRange","setDrawRange","Collection","options","getSpriteFunction","getSprite","Grid_forEach","pos","isCollection","gridCount","c","spriteFace","spriteInfo","cellSize","sprite","cubeFaces","spriteCube","cube","faces","createSpriteCollection","spriteMap","areaSize","spriteRegistry","spriteFunction","spriteCount","SpriteInfo","uid","enterArea","leaveArea","areaId","getAreaId","area","posId","move","selectedObj","getCamPos","xPos","yPos","spriteCollection","camPos","xArea","yArea","sprites","s","find","touchSpotX","touchSpotY","mdown","onDown","target","touches","changedTouches","touch","identifier","pageX","pageY","preventDefault","onUp","hasTouch","onMove","buttonDown","buttons","which","button","newX","newY","dx","dy","setOnTouch","deactivateTouch","activateTouch","removeEventListener","Mouse","requirejs","config","paths","threejs","dobuki","jsgif","urlArgs","match","DOK"],"mappings":"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","file":"dok.js","sourcesContent":["\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\ndefine('utils',[],function () {\n    /**\n     *  FUNCTION DEFINITIONS\n     */\n    function fixPath() {\n        var regex = /\\/$|index\\.html$|next\\.html$/g;\n        if (!regex.exec(location.pathname)) {\n            window.history.pushState(null, \"\", location.pathname + \"/\" + location.search + location.hash);\n        }\n    }\n\n    function changeScene(scene, htmlFile) {\n        if (typeof htmlFile === 'undefined') {\n            htmlFile = 'scene.html';\n        }\n        Utils.destroyEverything();\n        location.replace(\"../\" + scene + \"/\" + htmlFile);\n    }\n\n    function handleError(error, soft) {\n        if (Array.isArray(error)) {\n            var array = [];\n            for (var i = 0; i < error.length; i++) {\n                array.push(error[i]);\n                array.push(\"\\n \");\n            }\n            console.error.apply(null, array);\n        } else {\n            console.error(error);\n        }\n        Utils.lastError = error;\n        if (!soft) {\n            throw new Error(\"Last error terminated the process.\");\n        }\n    }\n\n    function combineMethods(firstMethod, secondMethod) {\n        return function () {\n            if (firstMethod) firstMethod();\n            if (secondMethod) secondMethod();\n        };\n    }\n\n    function expectParams(args) {\n        assert((typeof args === \"undefined\" ? \"undefined\" : _typeof(args)) === 'object', \"Pass 'arguments' to expectParams\");\n\n        for (var i = 1; i < arguments.length; i++) {\n            var type = args[i - 1] === null ? 'null' : Array.isArray(args[i - 1]) ? 'array' : _typeof(args[i - 1]);\n            assert(arguments[i].split(\"|\").indexOf(type) >= 0, [\"Expected argument \" + (i - 1) + \" to be \" + arguments[i] + \" NOT \" + type, args]);\n        }\n    }\n\n    function checkParams(args) {\n        assert((typeof args === \"undefined\" ? \"undefined\" : _typeof(args)) === 'object', \"Pass 'arguments' to expectParams\");\n\n        for (var i = 1; i < arguments.length; i++) {\n            var type = args[i - 1] === null ? 'null' : Array.isArray(args[i - 1]) ? 'array' : _typeof(args[i - 1]);\n            if (arguments[i].split(\"|\").indexOf(type) < 0) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    function assert(condition, message) {\n        if (!condition) {\n            handleError(message ? message : \"Assert failed: condition not met.\");\n        }\n    }\n\n    function cleanUp() {\n        Utils.destroyEverything();\n    }\n\n    function setupExit() {\n        document.onbeforeunload = window.onbeforeunload = cleanUp;\n    }\n\n    var destroyEverything = function destroyEverything() {};\n    function onDestroy(callback) {\n        destroyEverything = Utils.combineMethods(callback, destroyEverything);\n    }\n\n    function definePrototypes() {\n        if (typeof String.prototype.trim === \"undefined\") {\n            String.prototype.trim = function () {\n                return String(this).replace(/^\\s+|\\s+$/g, '');\n            };\n        }\n\n        if (!window.requestAnimationFrame) {\n            setupRequestAnimationFrame();\n        }\n\n        if (typeof Float32Array.prototype.fill === 'undefined') {\n            Float32Array.prototype.fill = fill_compat;\n        }\n\n        if (typeof Uint32Array.prototype.fill === 'undefined') {\n            Uint32Array.prototype.fill = fill_compat;\n        }\n\n        Array.prototype.getFrame = function (index) {\n            index = index | 0;\n            return this[index % this.length];\n        };\n        Number.prototype.getFrame = function () {\n            return this;\n        };\n    }\n\n    function fill_compat(value, start, end) {\n        start = start || 0;\n        end = end || this.length;\n        for (var i = start; i < end; i++) {\n            this[i] = value;\n        }\n        return this;\n    }\n\n    function setupRequestAnimationFrame() {\n        window.requestAnimationFrame = function () {\n            return window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || requestAnimationFrame_compat;\n        }();\n\n        var timeout,\n            time = 0;\n        function requestAnimationFrame_compat(callback) {\n            timeout = setTimeout(timeoutCallback, 1000 / 60, callback);\n        }\n\n        function timeoutCallback(callback) {\n            clearTimeout(timeout);\n            var dt = Date.now() - time;\n            callback(dt);\n            time = Date.now();\n        }\n    }\n\n    function loadAsyncHelper(src, result, index, callback, binary, method, data) {\n        loadAsync(src, function (value) {\n            result[index] = value;\n            for (var i = 0; i < result.length; i++) {\n                if (result[i] === undefined) {\n                    return;\n                }\n            }\n            callback.apply(null, result);\n        }, binary, method, data);\n    }\n\n    function loadAsync(src, callback, binary, method, data) {\n        if (Array.isArray(src)) {\n            var result = new Array(src.length);\n            for (var i = 0; i < src.length; i++) {\n                loadAsyncHelper(src[i], result, i, callback);\n            }\n        } else {\n            var xhr = new XMLHttpRequest();\n            xhr.overrideMimeType(binary ? \"text/plain; charset=x-user-defined\" : \"text/plain; charset=UTF-8\");\n            xhr.open(method ? method : \"GET\", src, true);\n            xhr.addEventListener('load', function (e) {\n                if (xhr.readyState === 4) {\n                    if (xhr.status === 200) {\n                        callback(xhr.responseText);\n                    } else {\n                        handleError(xhr.responseText);\n                    }\n                }\n            });\n            xhr.addEventListener('error', function (e) {\n                handleError(e);\n            });\n            xhr.send(data);\n        }\n    }\n\n    //      C\n    //     748\n    //    B3019\n    //     625\n    //      A\n\n\n    function Roundabout() {\n        this.x = 0;\n        this.y = 0;\n        this.left = -1;\n        this.right = 1;\n        this.top = -1;\n        this.bottom = 1;\n        this.direction = 0; //  0-right, 1-bottom, 2-left, 3-up\n\n        var point = [0, 0];\n\n        this.reset = function () {\n            this.x = 0;\n            this.y = 0;\n            this.left = -1;\n            this.right = 1;\n            this.top = -1;\n            this.bottom = 1;\n            this.direction = 0; //  0-right, 1-bottom, 2-left, 3-up\n        };\n\n        this.current = function () {\n            point[0] = this.x;\n            point[1] = this.y;\n            return point;\n        };\n\n        this.next = function () {\n            var point = this.current();\n            switch (this.direction) {\n                case 0:\n                    this.x++;\n                    if (this.x >= this.right) {\n                        this.right++;\n                        this.direction = (this.direction + 1) % 4; //  change dir\n                    }\n                    break;\n                case 1:\n                    this.y++;\n                    if (this.y >= this.bottom) {\n                        this.bottom++;\n                        this.direction = (this.direction + 1) % 4;\n                    }\n                    break;\n                case 2:\n                    this.x--;\n                    if (this.x <= this.left) {\n                        this.left--;\n                        this.direction = (this.direction + 1) % 4; //  change dir\n                    }\n                    break;\n                case 3:\n                    this.y--;\n                    if (this.y <= this.top) {\n                        this.top--;\n                        this.direction = (this.direction + 1) % 4; //  change dir\n                    }\n                    break;\n            }\n            return point;\n        };\n    }\n\n    function addLinkToHeadTag(rel, href) {\n        var link = document.createElement(\"link\");\n        link.setAttribute(\"rel\", rel);\n        link.href = href;\n        document.head.appendChild(link);\n    }\n\n    function getTitle() {\n        return title;\n    }\n\n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    var title = \"\";\n\n    function Utils() {\n        this.lastError = null;\n    }\n    Utils.handleError = handleError;\n    Utils.changeScene = changeScene;\n    Utils.destroyEverything = destroyEverything;\n    Utils.combineMethods = combineMethods;\n    Utils.expectParams = expectParams;\n    Utils.checkParams = checkParams;\n    Utils.assert = assert;\n    Utils.fixPath = fixPath;\n    Utils.onDestroy = onDestroy;\n    Utils.loadAsync = loadAsync;\n    Utils.Roundabout = Roundabout;\n    Utils.getTitle = getTitle;\n\n    /**\n     *   PROCESSES\n     */\n    setupExit();\n    definePrototypes();\n\n    /*    loadAsync(\"package.json\", function(str) {\n            try {\n                var object = JSON.parse(str);\n                var icon = object.window.icon || require.toUrl('images/logo.ico');\n                document.title = object.window.title || 'Dobuki Game';\n                addLinkToHeadTag(\"shortcut icon\", icon);\n                addLinkToHeadTag(\"apple-touch-icon\", object.window['apple-touch-icon'] || icon);\n            } catch(e) {\n            }\n        });\n    */\n\n    return Utils;\n});\n//# sourceMappingURL=utils.js.map;\n\n\ndefine('loop',['utils'], function (Utils) {\n    'use strict';\n\n    var coreLoops = null;\n    var frame = 0;\n    var fps = 0;\n    var period = Math.floor(1000 / 60);\n    var nextTime = 0;\n    var lastCount = 0;\n\n    var frameCount = 0;\n\n    /**\n    *  FUNCTION DEFINITIONS\n    */\n    function loop(time) {\n        if (coreLoops) {\n            requestAnimationFrame(loop);\n            if (time <= Loop.time + period) {\n                return;\n            }\n            Loop.time = Math.floor(time / period) * period;\n            for (var i = 0; coreLoops && i < coreLoops.length; i++) {\n                coreLoops[i]();\n            }\n            frameCount++;\n            if (time - lastCount > 1000) {\n                fps = frameCount;\n                frameCount = 0;\n                lastCount = time;\n            }\n        }\n    }\n\n    function addLoop(callback) {\n        if (coreLoops === null) {\n            coreLoops = [];\n            beginLoop();\n        }\n        coreLoops.push(callback);\n    }\n\n    function removeLoop(callback) {\n        if (coreLoops) {\n            var index = coreLoops.indexOf(callback);\n            coreLoops.splice(index, 1);\n            if (coreLoops.length === 0) {\n                coreLoops = null;\n            }\n        }\n    }\n\n    function beginLoop() {\n        loop(0);\n    }\n\n    function loopTime() {\n        return performance.now() - Loop.time;\n    }\n\n    function destroyEverything() {\n        coreLoops = null;\n        frame = 0;\n        fps = 0;\n        period = Math.floor(1000 / 60);\n        nextTime = 0;\n        lastCount = 0;\n        frameCount = 0;\n    }\n\n    /**\n    *  PUBLIC DECLARATIONS\n    */\n    function Loop() {}\n\n    Loop.addLoop = addLoop;\n    Loop.removeLoop = removeLoop;\n    Utils.onDestroy(Loop);\n\n    Object.defineProperty(Loop, \"fps\", {\n        enumerable: false,\n        configurable: false,\n        get: function get() {\n            return fps;\n        },\n        set: function set(value) {\n            period = Math.floor(1000 / value);\n        }\n    });\n\n    /**\n    *   PROCESSES\n    */\n    Loop.time = 0;\n\n    return Loop;\n});\n//# sourceMappingURL=loop.js.map;\n\n\ndefine('gifworker',['utils', 'loop'], function (Utils, Loop) {\n    var gifWorkerCallbacks = {};\n\n    function GifWorker() {\n        onmessage = function onmessage(e) {\n            var frameInfo = e.data.frameInfo;\n            var cData = e.data.cData;\n            var header = e.data.header;\n            var id = e.data.id;\n\n            if (frameInfo && cData && header) {\n                plasterPixels(frameInfo, cData, header);\n            }\n            postMessage({ id: id, cData: cData, frameInfo: frameInfo }, [cData.data.buffer]);\n        };\n\n        function plasterPixels(frameInfo, cData, header) {\n            var img = frameInfo.img;\n            var gce = frameInfo.gce;\n            var transparency = gce.transparencyGiven ? gce.transparencyIndex : null;\n            var disposalMethod = gce.disposalMethod;\n\n            var ct = img.lctFlag ? img.lct : header.gct;\n\n            img.pixels.forEach(function (pixel, i) {\n                if (transparency !== pixel) {\n                    // This includes null, if no transparency was defined.\n                    cData.data[i * 4] = ct[pixel][0];\n                    cData.data[i * 4 + 1] = ct[pixel][1];\n                    cData.data[i * 4 + 2] = ct[pixel][2];\n                    cData.data[i * 4 + 3] = 255; // Opaque.\n                } else if (disposalMethod === 2 || disposalMethod === 3) {\n                    cData.data[i * 4 + 3] = 0; // Transparent.\n                }\n            });\n        }\n    }\n\n    var code = GifWorker.toString();\n    code = code.substring(code.indexOf(\"{\") + 1, code.lastIndexOf(\"}\"));\n\n    var blob = new Blob([code], { type: \"application/javascript\" });\n    var gifWorker = new Worker(URL.createObjectURL(blob));\n\n    function initializeGifWorker(gifWorker) {\n        gifWorker.onmessage = function (e) {\n            gifWorkerCallbacks[e.data.id](e.data.cData, e.data.frameInfo);\n            delete gifWorkerCallbacks[e.data.id];\n        };\n    }\n\n    function sendToGifWorker(frameInfo, cData, header, callback) {\n        require(['https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.7.0/js/md5.min.js'], function (md5) {\n            var id = md5(Math.random() + \"\" + Loop.time);\n            gifWorkerCallbacks[id] = callback;\n            gifWorker.postMessage({\n                frameInfo: frameInfo,\n                cData: cData,\n                header: header,\n                id: id\n            }, [cData.data.buffer]);\n        });\n    }\n\n    initializeGifWorker(gifWorker);\n\n    gifWorker.send = sendToGifWorker;\n\n    function destroyEverything() {\n        if (gifWorker) {\n            gifWorker.terminate();\n        }\n        gifWorker = null;\n        gifWorkerCallbacks = null;\n    }\n\n    Utils.onDestroy(destroyEverything);\n\n    return gifWorker;\n});\n//# sourceMappingURL=gifworker.js.map;\n\n\ndefine('gifHandler',['utils', 'loop', 'gifworker'], function (Utils, Loop, gifWorker) {\n    'use strict';\n\n    var gifs = {};\n\n    /**\n     *  CLASS DEFINITIONS\n     */\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */\n    function isGif(src) {\n        return gifs[src] && gifs[src].block || src.split(\"?\")[0].slice(-4).toLowerCase() === \".gif\" || src.indexOf(\"data:image/gif;\") === 0;\n    }\n\n    function getGif(src) {\n        if (!gifs[src]) {\n            gifs[src] = createGif(src);\n        }\n        return gifs[src];\n    }\n\n    function createGif(src) {\n        var renderTime = 0;\n        var currentFrame = 0;\n        var maxFrameCompleted = 0;\n\n        var gifInfo = {\n            framesProcessed: 0,\n            header: null,\n            frameInfos: [],\n            block: null,\n            canvases: [],\n            callbacks: [],\n            processNextFrame: function processNextFrame() {\n                var frame = this.framesProcessed;\n                var frameInfo = this.frameInfos[frame];\n\n                if (frameInfo && frameInfo.gce && frameInfo.img && this.header) {\n                    var canvas = document.createElement(\"canvas\");\n                    canvas.style.position = \"absolute\";\n                    canvas.style.left = 0;\n                    canvas.style.top = 0;\n                    canvas.width = this.header.width;\n                    canvas.height = this.header.height;\n                    var ctx = canvas.getContext(\"2d\");\n                    ctx.webkitImageSmoothingEnabled = false;\n                    ctx.imageSmoothingEnabled = false;\n                    ctx.msImageSmoothingEnabled = false;\n\n                    this.canvases[frame] = canvas;\n                    if (frame > 0) {\n                        //  copy previous frame. That's how gifs work\n                        ctx.drawImage(this.canvases[frame - 1], 0, 0);\n                    }\n\n                    var cData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\n                    var self = this;\n                    var processNext = this.processNextFrame.bind(this);\n                    gifWorker.send(frameInfo, cData, this.header, function (cData, frameInfo) {\n                        ctx.putImageData(cData, 0, 0);\n                        if (self.callbacks[frameInfo.frame]) {\n                            self.callbacks[frameInfo.frame]();\n                        }\n                        maxFrameCompleted = frameInfo.frame;\n                        self.frameInfos[frameInfo.frame].ready = true;\n                        processNext();\n                    });\n                    currentFrame = this.framesProcessed;\n                    this.framesProcessed++;\n                    //                    document.body.appendChild(canvas);\n                }\n            },\n            hdr: function hdr(_hdr) {\n                this.header = _hdr;\n            },\n            gce: function gce(_gce) {\n                if (this.frameInfos.length == 0 || this.frameInfos[this.frameInfos.length - 1].gce) {\n                    this.frameInfos.push({\n                        gce: null,\n                        cycleTime: null,\n                        img: null,\n                        frame: this.frameInfos.length,\n                        ready: false\n                    });\n                }\n                var currentIndex = this.frameInfos.length - 1;\n                this.frameInfos[currentIndex].gce = _gce;\n                if (!_gce.delayTime) {\n                    _gce.delayTime = 1;\n                }\n                this.frameInfos[currentIndex].cycleTime = _gce.delayTime * 10 + (currentIndex === 0 ? 0 : this.frameInfos[currentIndex - 1].cycleTime);\n                this.processNextFrame();\n            },\n            img: function img(_img) {\n                if (this.frameInfos.length === 0 || this.frameInfos[this.frameInfos.length - 1].img) {\n                    this.frameInfos.push({});\n                }\n                this.frameInfos[this.frameInfos.length - 1].img = _img;\n                this.processNextFrame();\n            },\n            getFrame: function getFrame() {\n                if (this.block && Loop.time > renderTime) {\n                    currentFrame = (currentFrame + 1) % this.frameInfos.length;\n                    var totalAnimationTime = this.frameInfos[this.frameInfos.length - 1].cycleTime;\n                    renderTime = Math.floor(Loop.time / totalAnimationTime) * totalAnimationTime + this.frameInfos[currentFrame].cycleTime;\n                }\n                return Math.min(currentFrame, maxFrameCompleted);\n            },\n            eof: function eof(block) {\n                this.block = block;\n                this.processNextFrame();\n            }\n        };\n\n        Utils.loadAsync(src, function (content) {\n            require(['https://jacklehamster.github.io/jsgif/gif.js'], function () {\n                parseGIF(new Stream(content), gifInfo);\n            });\n        }, true);\n\n        return gifInfo;\n    }\n\n    function destroyEverything() {\n        gifs = {};\n    }\n\n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    function GifHandler() {}\n\n    GifHandler.getGif = getGif;\n    GifHandler.isGif = isGif;\n    Utils.onDestroy(destroyEverything);\n\n    return GifHandler;\n});\n//# sourceMappingURL=gifhandler.js.map;\n\n\ndefine('camera',['threejs', 'loop'], function (THREE, Loop) {\n    'use strict';\n\n    var camera;\n    var camera2d = new THREE.OrthographicCamera(-innerWidth / 2, innerWidth / 2, innerHeight / 2, -innerHeight / 2, 0.1, 1000000);\n    var camera3d = new THREE.PerspectiveCamera(75, innerWidth / innerHeight, 0.1, 1000000);\n    var cameraQuaternionData = {\n        array: new Float32Array(4),\n        forwardMovement: new THREE.Vector3(0, 0, 1),\n        version: 0\n    },\n        lastQuat = new THREE.Quaternion(),\n        tempQuat = new THREE.Quaternion(),\n        tempQuatArray = new Float32Array(4),\n        upVector = new THREE.Vector3(0, 1, 0);\n    var groundQuat = new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 2);\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */\n    function getCamera() {\n        return camera;\n    }\n\n    function nop() {}\n\n    function setCamera3d(value) {\n        if (value && camera !== camera3d) {\n            camera = camera3d;\n            copyCamera(camera2d, camera);\n        } else if (!value && camera === camera3d) {\n            camera = camera2d;\n            copyCamera(camera3d, camera);\n        }\n        updateQuaternionData();\n    }\n\n    function updateQuaternionData() {\n        camera.quaternion.toArray(cameraQuaternionData.array);\n        cameraQuaternionData.forwardMovement.set(0, 0, 1);\n        cameraQuaternionData.forwardMovement.applyQuaternion(camera.quaternion);\n    }\n\n    function getCameraQuaternionData() {\n        if (!camera.quaternion.equals(lastQuat)) {\n            updateQuaternionData();\n            lastQuat.copy(camera.quaternion);\n        }\n        return cameraQuaternionData;\n    }\n\n    function initCameras() {\n        camera2d.position.set(0, 0, 400);\n        camera3d.position.set(0, 0, 400);\n    }\n\n    function isCamera3d() {\n        return camera === camera3d;\n    }\n\n    function copyCamera(from, to) {\n        to.position.copy(from.position);\n        to.quaternion.copy(from.quaternion);\n    }\n\n    function getCameraPosition() {\n        return {\n            'is3d': isCamera3d(),\n            'position': camera.position.toArray(),\n            'quaternion': camera.quaternion.toArray()\n        };\n    }\n\n    function setCameraPosition(data) {\n        setCamera3d(data.is3d);\n        camera.quaternion.fromArray(data.quaternion);\n        camera.position.fromArray(data.position);\n        camera.updateProjectionMatrix();\n    }\n\n    function shadowQuatArray(x, y) {\n        var angle = -Math.atan2(y - camera.position.z, x - camera.position.x) - Math.PI / 2;\n        tempQuat.setFromAxisAngle(upVector, angle);\n        tempQuat.multiply(groundQuat);\n        return tempQuat.toArray(tempQuatArray);\n    }\n\n    function quaternionArrays() {\n        var quaternions = {};\n        quaternions.groundQuaternionArray = new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 2).toArray(new Float32Array(4));\n        quaternions.southQuaternionArray = new THREE.Quaternion().toArray(new Float32Array(4));\n        quaternions.northQuaternionArray = new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0, 1, 0), -Math.PI).toArray(new Float32Array(4));\n        quaternions.westQuaternionArray = new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0, 1, 0), -Math.PI / 2).toArray(new Float32Array(4));\n        quaternions.eastQuaternionArray = new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0, 1, 0), Math.PI / 2).toArray(new Float32Array(4));\n        quaternions.ceilingQuaternionArray = new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(1, 0, 0), Math.PI / 2).toArray(new Float32Array(4));\n        return quaternions;\n    }\n\n    function checkWindowSize() {\n        var gameWidth = innerWidth;\n        var gameHeight = innerHeight;\n        camera2d.left = -gameWidth / 2;\n        camera2d.right = gameWidth / 2;\n        camera2d.top = gameHeight / 2;\n        camera2d.bottom = -gameHeight / 2;\n        camera2d.updateProjectionMatrix();\n        camera3d.aspect = gameWidth / gameHeight;\n        camera3d.updateProjectionMatrix();\n    }\n\n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    function Camera() {}\n\n    Camera.setCamera3d = setCamera3d;\n    Camera.isCamera3d = isCamera3d;\n    Camera.getCamera = getCamera;\n    Camera.setCameraPosition = setCameraPosition;\n    Camera.getCameraPosition = getCameraPosition;\n    Camera.getCameraQuaternionData = getCameraQuaternionData;\n    Camera.shadowQuatArray = shadowQuatArray;\n    Camera.quaternions = quaternionArrays();\n\n    /**\n     *   PROCESSES\n     */\n    initCameras();\n    setCamera3d(true);\n\n    Loop.addLoop(checkWindowSize);\n\n    return Camera;\n});\n//# sourceMappingURL=camera.js.map;\n\n\ndefine('objectpool',['utils'], function (Utils) {\n\n    /**\n     *  CLASS DEFINITIONS\n     */\n    function ObjectPool(classObject) {\n        this.pool = [];\n        this.classObject = classObject;\n    }\n    ObjectPool.prototype.classObject = null;\n    ObjectPool.prototype.pool = null;\n    ObjectPool.prototype.index = 0;\n    ObjectPool.prototype.create = create;\n    ObjectPool.prototype.recycleAll = recycleAll;\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */\n    function create() {\n        if (this.index >= this.pool.length) {\n            this.pool.push(new this.classObject());\n        }\n        return this.pool[this.index++];\n    }\n\n    function recycleAll() {\n        this.index = 0;\n    }\n\n    function pool_create(classObject) {\n        if (!classObject.pool) {\n            classObject.pool = new ObjectPool(classObject);\n        }\n        return classObject.pool.create();\n    }\n\n    function pool_recycleAll(classObject) {\n        if (classObject.pool) {\n            classObject.pool.recycleAll();\n        }\n    }\n\n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    ObjectPool.create = pool_create;\n    ObjectPool.recycleAll = pool_recycleAll;\n\n    return ObjectPool;\n});\n//# sourceMappingURL=objectpool.js.map;\n\n\ndefine('spriteobject',['threejs', 'objectpool'], function (THREE, ObjectPool) {\n    'use strict';\n\n    function SpriteObject() {\n        this.position = new THREE.Vector3();\n        this.size = new Float32Array([0, 0, 1]);\n        this.quaternionArray = new Float32Array(4).fill(0);\n    }\n\n    SpriteObject.prototype.init = function (x, y, z, width, height, quaternionArray, light, img) {\n        this.position.set(x, y, z);\n        this.size[0] = width;\n        this.size[1] = height;\n        this.hasQuaternionArray = quaternionArray !== null;\n        if (quaternionArray) {\n            this.quaternionArray.set(quaternionArray);\n        }\n        this.light = light;\n        this.img = img;\n        return this;\n    };\n    SpriteObject.prototype.position = null;\n    SpriteObject.prototype.size = null;\n    SpriteObject.prototype.hasQuaternionArray = false;\n    SpriteObject.prototype.quaternionArray = null;\n    SpriteObject.prototype.light = 1;\n    SpriteObject.prototype.img = -1;\n    SpriteObject.prototype.offset = null;\n\n    SpriteObject.create = function (x, y, z, width, height, quaternionArray, light, img) {\n        return ObjectPool.create(SpriteObject).init(x, y, z, width, height, quaternionArray, light, img);\n    };\n\n    return SpriteObject;\n});\n//# sourceMappingURL=spriteobject.js.map;\n\n\ndefine('packer',['utils'], function (Utils) {\n\n    'use strict';\n\n    var MAX_TEXTURES = 16;\n    var SPRITE_SHEET_SIZE = 2048;\n    var CHUNKSIZES = 8;\n\n    var chunks = [];\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */\n\n    function doesFit(tex, x, y, width, height) {\n        if (x + width > SPRITE_SHEET_SIZE || y + height > SPRITE_SHEET_SIZE) return false;\n\n        if (chunks[tex]) {\n            for (var xi = 0; xi < width; xi++) {\n                if (chunks[tex][x + xi]) {\n                    for (var yi = 0; yi < height; yi++) {\n                        if (chunks[tex][x + xi][y + yi]) {\n                            return false;\n                        }\n                    }\n                }\n            }\n        }\n\n        return true;\n    }\n\n    function findSlot(canvas) {\n        if (canvas.width <= 1 && canvas.height <= 1) {\n            return null;\n        }\n        if (canvas.width > SPRITE_SHEET_SIZE || canvas.height > SPRITE_SHEET_SIZE) {\n            return null;\n        }\n        var chunkWidth = Math.ceil(canvas.width / CHUNKSIZES);\n        var chunkHeight = Math.ceil(canvas.height / CHUNKSIZES);\n\n        for (var tex = 0; tex < MAX_TEXTURES; tex++) {\n            for (var x = 0; x < SPRITE_SHEET_SIZE / CHUNKSIZES - chunkWidth; x++) {\n                for (var y = 0; y < SPRITE_SHEET_SIZE / CHUNKSIZES - chunkHeight; y++) {\n                    if (doesFit(tex, x, y, chunkWidth, chunkHeight)) {\n                        return { tex: tex, x: x * CHUNKSIZES, y: y * CHUNKSIZES };\n                    }\n                }\n            }\n        }\n        return null;\n    }\n\n    function fillSlot(tex, x, y, canvas) {\n        if (!chunks[tex]) chunks[tex] = [];\n        var chunkWidth = Math.ceil((canvas.width + 1) / CHUNKSIZES);\n        var chunkHeight = Math.ceil((canvas.height + 1) / CHUNKSIZES);\n\n        for (var xi = 0; xi < chunkWidth; xi++) {\n            if (!chunks[tex][x / CHUNKSIZES + xi]) chunks[tex][x / CHUNKSIZES + xi] = [];\n            for (var yi = 0; yi < chunkHeight; yi++) {\n                chunks[tex][x / CHUNKSIZES + xi][y / CHUNKSIZES + yi] = canvas;\n            }\n        }\n    }\n\n    function getSlot(canvas) {\n        var slot = findSlot(canvas);\n        if (slot) {\n            fillSlot(slot.tex, slot.x, slot.y, canvas);\n        }\n        return slot;\n    }\n\n    function destroyEverything() {\n        chunks.length = 0;\n    }\n\n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    function Packer() {}\n\n    Packer.getSlot = getSlot;\n\n    Utils.onDestroy(destroyEverything);\n\n    /**\n     *   PROCESSES\n     */\n\n    return Packer;\n});\n//# sourceMappingURL=packer.js.map;\n\n\ndefine('gifhandler',['utils', 'loop', 'gifworker'], function (Utils, Loop, gifWorker) {\n    'use strict';\n\n    var gifs = {};\n\n    /**\n     *  CLASS DEFINITIONS\n     */\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */\n    function isGif(src) {\n        return gifs[src] && gifs[src].block || src.split(\"?\")[0].slice(-4).toLowerCase() === \".gif\" || src.indexOf(\"data:image/gif;\") === 0;\n    }\n\n    function getGif(src) {\n        if (!gifs[src]) {\n            gifs[src] = createGif(src);\n        }\n        return gifs[src];\n    }\n\n    function createGif(src) {\n        var renderTime = 0;\n        var currentFrame = 0;\n        var maxFrameCompleted = 0;\n\n        var gifInfo = {\n            framesProcessed: 0,\n            header: null,\n            frameInfos: [],\n            block: null,\n            canvases: [],\n            callbacks: [],\n            processNextFrame: function processNextFrame() {\n                var frame = this.framesProcessed;\n                var frameInfo = this.frameInfos[frame];\n\n                if (frameInfo && frameInfo.gce && frameInfo.img && this.header) {\n                    var canvas = document.createElement(\"canvas\");\n                    canvas.style.position = \"absolute\";\n                    canvas.style.left = 0;\n                    canvas.style.top = 0;\n                    canvas.width = this.header.width;\n                    canvas.height = this.header.height;\n                    var ctx = canvas.getContext(\"2d\");\n                    ctx.webkitImageSmoothingEnabled = false;\n                    ctx.imageSmoothingEnabled = false;\n                    ctx.msImageSmoothingEnabled = false;\n\n                    this.canvases[frame] = canvas;\n                    if (frame > 0) {\n                        //  copy previous frame. That's how gifs work\n                        ctx.drawImage(this.canvases[frame - 1], 0, 0);\n                    }\n\n                    var cData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\n                    var self = this;\n                    var processNext = this.processNextFrame.bind(this);\n                    gifWorker.send(frameInfo, cData, this.header, function (cData, frameInfo) {\n                        ctx.putImageData(cData, 0, 0);\n                        if (self.callbacks[frameInfo.frame]) {\n                            self.callbacks[frameInfo.frame]();\n                        }\n                        maxFrameCompleted = frameInfo.frame;\n                        self.frameInfos[frameInfo.frame].ready = true;\n                        processNext();\n                    });\n                    currentFrame = this.framesProcessed;\n                    this.framesProcessed++;\n                    //                    document.body.appendChild(canvas);\n                }\n            },\n            hdr: function hdr(_hdr) {\n                this.header = _hdr;\n            },\n            gce: function gce(_gce) {\n                if (this.frameInfos.length == 0 || this.frameInfos[this.frameInfos.length - 1].gce) {\n                    this.frameInfos.push({\n                        gce: null,\n                        cycleTime: null,\n                        img: null,\n                        frame: this.frameInfos.length,\n                        ready: false\n                    });\n                }\n                var currentIndex = this.frameInfos.length - 1;\n                this.frameInfos[currentIndex].gce = _gce;\n                if (!_gce.delayTime) {\n                    _gce.delayTime = 1;\n                }\n                this.frameInfos[currentIndex].cycleTime = _gce.delayTime * 10 + (currentIndex === 0 ? 0 : this.frameInfos[currentIndex - 1].cycleTime);\n                this.processNextFrame();\n            },\n            img: function img(_img) {\n                if (this.frameInfos.length === 0 || this.frameInfos[this.frameInfos.length - 1].img) {\n                    this.frameInfos.push({});\n                }\n                this.frameInfos[this.frameInfos.length - 1].img = _img;\n                this.processNextFrame();\n            },\n            getFrame: function getFrame() {\n                if (this.block && Loop.time > renderTime) {\n                    currentFrame = (currentFrame + 1) % this.frameInfos.length;\n                    var totalAnimationTime = this.frameInfos[this.frameInfos.length - 1].cycleTime;\n                    renderTime = Math.floor(Loop.time / totalAnimationTime) * totalAnimationTime + this.frameInfos[currentFrame].cycleTime;\n                }\n                return Math.min(currentFrame, maxFrameCompleted);\n            },\n            eof: function eof(block) {\n                this.block = block;\n                this.processNextFrame();\n            }\n        };\n\n        Utils.loadAsync(src, function (content) {\n            require(['https://jacklehamster.github.io/jsgif/gif.js'], function () {\n                parseGIF(new Stream(content), gifInfo);\n            });\n        }, true);\n\n        return gifInfo;\n    }\n\n    function destroyEverything() {\n        gifs = {};\n    }\n\n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    function GifHandler() {}\n\n    GifHandler.getGif = getGif;\n    GifHandler.isGif = isGif;\n    Utils.onDestroy(destroyEverything);\n\n    return GifHandler;\n});\n//# sourceMappingURL=gifhandler.js.map;\n\n\ndefine('loader',['utils', 'loop'], function (Utils, Loop) {\n    'use strict';\n\n    var index = 0;\n    var imageQueue = [];\n    var loadLimit = 3;\n    var loading = 0;\n    var loadingBar = null;\n    var visualProgress = 0;\n    var onLoadCallback = null;\n    var loaded = 0;\n    var loadTotal = 0;\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */\n    function setOnLoad(onLoad) {\n        onLoadCallback = onLoad;\n        document.body.removeChild(getLoadingBar());\n    }\n\n    function loadImage(url, onLoad) {\n        var image = new Image();\n        image.onload = function (event) {\n            onLoad.call(image, event);\n            loading--;\n            loaded++;\n            checkLoad();\n        };\n        image.crossOrigin = '';\n        imageQueue.push({\n            image: image,\n            url: url\n        });\n        loadTotal++;\n        checkLoad();\n        return image;\n    }\n\n    function loadFile(url, onLoad) {\n        loadTotal++;\n        Utils.loadAsync(url, function (result) {\n            loaded++;\n            onLoad(result);\n        });\n    }\n\n    function checkLoad() {\n        while (index < imageQueue.length && loading < loadLimit) {\n            imageQueue[index].image.src = imageQueue[index].url;\n            index++;\n            loading++;\n        }\n        if (index === imageQueue.length) {\n            index = 0;\n            imageQueue.length = 0;\n            loaded = 0;\n            loadTotal = 0;\n        }\n    }\n\n    function getLoadingProgress() {\n        return !loadTotal ? 1 : loaded / loadTotal;\n    }\n\n    function refreshLoadingBar() {\n        if (loadingBar) {\n            var ctx = loadingBar.getContext(\"2d\");\n            var actualProgress = getLoadingProgress();\n            visualProgress = Math.max(0, visualProgress + (actualProgress - visualProgress) / 10);\n            if (actualProgress >= 1) {\n                visualProgress = 1;\n                Loop.removeLoop(refreshLoadingBar);\n            }\n            ctx.fillRect(10, 10, (loadingBar.width - 20) * visualProgress, loadingBar.height - 20);\n\n            if (actualProgress >= 1) {\n                if (onLoadCallback) {\n                    setTimeout(onLoadCallback, 100);\n                }\n            }\n        }\n    }\n\n    function getLoadingBar() {\n        if (!loadingBar) {\n            loadingBar = document.createElement(\"canvas\");\n            loadingBar.id = \"loading\";\n            loadingBar.width = Math.round(innerWidth * 2 * 2 / 3);\n            loadingBar.height = 50;\n            loadingBar.style.left = innerWidth / 2 - loadingBar.width / 4 + \"px\";\n            loadingBar.style.top = innerHeight / 2 - loadingBar.height / 4 + \"px\";\n            loadingBar.style.width = loadingBar.width / 2 + \"px\";\n            loadingBar.style.height = loadingBar.height / 2 + \"px\";\n            loadingBar.style.position = \"absolute\";\n            loadingBar.style.backgroundColor = \"white\";\n            loadingBar.style.border = \"10px double #00DDDD\";\n            var ctx = loadingBar.getContext(\"2d\");\n            ctx.fillStyle = \"#0066aa\";\n            Loop.addLoop(refreshLoadingBar);\n        }\n        document.body.appendChild(loadingBar);\n        return loadingBar;\n    }\n\n    function destroyEverything() {\n        imageQueue.length = 0;\n    }\n\n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    function Loader() {}\n\n    Loader.loadImage = loadImage;\n    Loader.loadFile = loadFile;\n    Loader.getLoadingProgress = getLoadingProgress;\n    Loader.getLoadingBar = getLoadingBar;\n    Loader.setOnLoad = setOnLoad;\n\n    Utils.onDestroy(destroyEverything);\n\n    return Loader;\n});\n//# sourceMappingURL=loader.js.map;\n\n\ndefine('spritesheet',['threejs', 'utils', 'gifhandler', 'loader', 'packer'], function (THREE, Utils, GifHandler, Loader, Packer) {\n    'use strict';\n\n    var canvases = {};\n    var cuts = {};\n    var cutArray = [];\n    var cutCount = 0;\n\n    var textures = [null];\n    var slots = {};\n    var SPRITE_SHEET_SIZE = 2048;\n    var planeGeometry = new THREE.PlaneBufferGeometry(1, 1);\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */\n    function getCanvas(url, canCreate) {\n        if (!canvases[url] && canCreate) {\n            var canvas = canvases[url] = document.createElement('canvas');\n            canvas.setAttribute(\"url\", url);\n            if (url.indexOf(\"tex-\") === 0) {\n                canvas.width = canvas.height = SPRITE_SHEET_SIZE;\n                var index = parseInt(url.split(\"-\").pop());\n                var tex = new THREE.Texture(canvas);\n                tex.magFilter = THREE.NearestFilter;\n                tex.minFilter = THREE.LinearMipMapLinearFilter;\n                canvas.addEventListener(\"update\", updateTextureEvent);\n                textures[index] = tex;\n                canvas.setAttribute(\"texture\", index.toString());\n                canvas.style.position = \"absolute\";\n                canvas.style.left = 0;\n                canvas.style.top = 0;\n\n                //                document.body.appendChild(canvas);\n            } else {\n                canvas.width = canvas.height = 1;\n            }\n            initCanvas(canvas);\n        }\n        return canvases[url];\n    }\n\n    function initCanvas(canvas) {\n        var context = canvas.getContext(\"2d\");\n        context.webkitImageSmoothingEnabled = false;\n        context.imageSmoothingEnabled = false;\n        context.msImageSmoothingEnabled = false;\n    }\n\n    function customEvent(type, detail) {\n        var evt = document.createEvent(\"CustomEvent\");\n        evt.initCustomEvent(type, false, false, detail || {});\n        return evt;\n    }\n\n    function fetchCanvas(urlpipe, frame) {\n        var canvas = getCanvas(frame + \":\" + urlpipe.join(\"|\"));\n        if (canvas) {\n            return canvas;\n        }\n\n        if (urlpipe.length > 1) {\n            canvas = getCanvas(frame + \":\" + urlpipe.join(\"|\"), true);\n            var subpipe = urlpipe.slice(0, urlpipe.length - 1);\n            var processString = urlpipe[urlpipe.length - 1];\n            var subCanvas = fetchCanvas(subpipe, frame);\n            canvas.setAttribute(\"base-url\", subCanvas.getAttribute(\"base-url\"));\n            processCanvas(subCanvas, processString, canvas);\n            subCanvas.addEventListener(\"update\", function (event) {\n                var subCanvas = event.currentTarget;\n                processCanvas(subCanvas, processString, canvas);\n                canvas.dispatchEvent(customEvent(\"update\"));\n            });\n            return canvas;\n        } else {\n            var url = urlpipe[0];\n            canvas = getCanvas(frame + \":\" + url, true);\n\n            //  check for width x height\n            var size = url.split(\"x\");\n            if (size.length === 2 && !isNaN(parseInt(size[0])) && !isNaN(parseInt(size[1]))) {\n                canvas.width = parseInt(size[0]);\n                canvas.height = parseInt(size[1]);\n            } else if (GifHandler.isGif(url)) {\n                var gif = GifHandler.getGif(url);\n                canvas.setAttribute(\"animated\", true);\n                canvas.setAttribute(\"base-url\", url);\n                if (gif.frameInfos[frame] && gif.frameInfos[frame].ready) {\n                    drawGif(gif, frame, canvas);\n                } else {\n                    gif.callbacks[frame] = drawGif.bind(null, gif, frame, canvas);\n                }\n            } else {\n                canvas.setAttribute(\"base-url\", url);\n                var image = Loader.loadImage(url, function () {\n                    canvas.width = image.naturalWidth;\n                    canvas.height = image.naturalHeight;\n                    initCanvas(canvas);\n                    canvas.getContext(\"2d\").drawImage(image, 0, 0);\n                    //                    document.body.appendChild(canvas);\n                    canvas.dispatchEvent(customEvent(\"update\"));\n                });\n            }\n            return canvas;\n        }\n    }\n\n    function drawGif(gif, frame, canvas) {\n        canvas.width = gif.header.width;\n        canvas.height = gif.header.height;\n        initCanvas(canvas);\n        canvas.getContext(\"2d\").drawImage(gif.canvases[frame], 0, 0);\n        canvas.dispatchEvent(customEvent(\"update\"));\n    }\n\n    function processCanvas(canvas, processString, outputCanvas) {\n        //  check size split\n        var outputCtx = outputCanvas.getContext(\"2d\");\n        var splits = processString.split(\",\");\n        if (splits.length === 4 && splits.every(function (num) {\n            return !isNaN(num);\n        })) {\n            splits = splits.map(function (o) {\n                return parseInt(o);\n            });\n            var drawWidth = Math.min(canvas.width - splits[0], splits[2]);\n            var drawHeight = Math.min(canvas.height - splits[1], splits[3]);\n            if (drawWidth > 0 && drawHeight > 0) {\n                outputCanvas.width = drawWidth;\n                outputCanvas.height = drawHeight;\n                initCanvas(outputCanvas);\n                outputCtx.drawImage(canvas, splits[0], splits[1], drawWidth, drawHeight, 0, 0, drawWidth, drawHeight);\n            }\n        } else if (processString.indexOf(\"scale:\") === 0) {\n            if (canvas.width > 1 && canvas.height > 1) {\n                var scale = processString.split(\":\")[1].split(\",\");\n                outputCanvas.width = Math.ceil(canvas.width * Math.abs(scale[0]));\n                outputCanvas.height = Math.ceil(canvas.height * Math.abs(scale[1 % scale.length]));\n                initCanvas(outputCanvas);\n                if (scale[0] < 0 || scale[1 % scale.length] < 0) {\n                    var sign = [scale[0] < 0 ? -1 : 1, scale[1 % scale.length] < 0 ? -1 : 1];\n                    outputCtx.translate(sign[0] < 0 ? outputCanvas.width : 0, sign[1] < 0 ? outputCanvas.height : 0);\n                    outputCtx.scale(sign[0], sign[1]);\n                }\n                outputCtx.drawImage(canvas, 0, 0, canvas.width, canvas.height, 0, 0, outputCanvas.width, outputCanvas.height);\n                outputCtx.restore();\n            }\n        } else if (processString.indexOf(\"border\") === 0) {\n            outputCanvas.width = canvas.width;\n            outputCanvas.height = canvas.height;\n            initCanvas(outputCanvas);\n            var borderWidth = processString.split(\":\")[1] || 1;\n            if (borderWidth.indexOf(\"%\") > 0) {\n                borderWidth = Math.round(parseFloat(borderWidth.split(\"%\")[0]) / 100 * Math.min(outputCanvas.width, outputCanvas.height));\n            }\n            outputCtx.drawImage(canvas, 0, 0);\n            outputCtx.beginPath();\n            for (var i = 0; i < borderWidth; i++) {\n                outputCtx.rect(i, i, canvas.width - 1 - i * 2, canvas.height - 1 - i * 2);\n            }\n            outputCtx.stroke();\n        } else if (processString.indexOf(\"text:\") === 0) {\n            outputCanvas.width = canvas.width;\n            outputCanvas.height = canvas.height;\n            initCanvas(outputCanvas);\n            outputCtx.fillStyle = \"#000000\";\n            outputCtx.font = '18px Comic';\n            outputCtx.fillText(processString.split(\"text:\")[1], 0, canvas.height);\n        } else if (processString.indexOf(\"shadow\") === 0) {\n            outputCanvas.width = canvas.width;\n            outputCanvas.height = canvas.height;\n            initCanvas(outputCanvas);\n            var ctx = canvas.getContext(\"2d\");\n            var data = ctx.getImageData(0, 0, canvas.width, canvas.height);\n            for (var i = 0; i < data.data.length; i += 4) {\n                if (data.data[i + 3] !== 0) {\n                    data.data[i] = 0;\n                    data.data[i + 1] = 0;\n                    data.data[i + 2] = 0;\n                    data.data[i + 3] = 127;\n                }\n            }\n            outputCtx.putImageData(data, 0, 0);\n        } else if (processString.indexOf(\"cross\") === 0) {\n            outputCanvas.width = canvas.width;\n            outputCanvas.height = canvas.height;\n            initCanvas(outputCanvas);\n            outputCtx.drawImage(canvas, 0, 0);\n            outputCtx.beginPath();\n            outputCtx.moveTo(canvas.width / 2, 0);\n            outputCtx.lineTo(canvas.width / 2, canvas.height);\n            outputCtx.moveTo(0, canvas.height / 2);\n            outputCtx.lineTo(canvas.width, canvas.height / 2);\n            outputCtx.stroke();\n        }\n    }\n\n    function getCut(index) {\n        var cut = cutArray[index];\n        var frame = cut && cut.animated ? GifHandler.getGif(cut.url).getFrame() : 0;\n        if (cut && cut.cut[frame] && cut.cut[frame].ready) {\n            return cut.cut[frame];\n        }\n        if (cut && cut.url) {\n            cut = getCutByURL(cut.url, frame);\n            return cut.cut[frame];\n        }\n        return null;\n    }\n\n    function getCutByURL(url, frame) {\n        if (cuts[url] && cuts[url].cut[frame] && cuts[url].cut[frame].ready) {\n            return cuts[url];\n        }\n\n        var canvas = fetchCanvas(url.split(\"|\"), frame);\n        var slot = Packer.getSlot(canvas);\n\n        var cut = cuts[url];\n        if (!cut) {\n            cut = {\n                index: cutCount++,\n                url: url,\n                baseUrl: null,\n                cut: [],\n                animated: false\n            };\n            cuts[url] = cut;\n            cutArray[cut.index] = cut;\n        }\n        if (!cut.cut[frame]) {\n            cut.cut[frame] = {\n                tex: 0, uv: null, ready: false,\n                url: url, baseUrl: null\n            };\n        }\n\n        if (slot) {\n            slots[canvas.getAttribute(\"url\")] = slot;\n            canvas.addEventListener(\"update\", updateSpritesheetEvent);\n            canvas.dispatchEvent(customEvent(\"update\"));\n\n            var uvX = slot.x / SPRITE_SHEET_SIZE;\n            var uvY = slot.y / SPRITE_SHEET_SIZE;\n            var uvW = canvas.width / SPRITE_SHEET_SIZE;\n            var uvH = canvas.height / SPRITE_SHEET_SIZE;\n            var uvOrder = planeGeometry.attributes.uv.array;\n\n            var cutcut = [uvX, 1 - uvY - uvH, uvX + uvW, 1 - uvY];\n\n            cut.animated = canvas.getAttribute(\"animated\") === \"true\";\n            cut.cut[frame].baseUrl = cut.baseUrl = canvas.getAttribute(\"base-url\");\n            cut.cut[frame].tex = slot.tex;\n            cut.cut[frame].uv = new Float32Array(uvOrder.length);\n            for (var u = 0; u < uvOrder.length; u++) {\n                cut.cut[frame].uv[u] = cutcut[uvOrder[u] * 2 + u % 2];\n            }\n            cut.cut[frame].ready = true;\n            //            console.log(canvas);\n            return cut;\n        } else {\n            return cut;\n        }\n    }\n\n    function preLoad(images, root) {\n        if (root === undefined) {\n            root = SpriteSheet.spritesheet;\n        }\n        if (typeof images === \"string\") {\n            var cut = getCutByURL(images, 0);\n            if (cut) {\n                return cut.index;\n            }\n        } else {\n            for (var prop in images) {\n                if (images.hasOwnProperty(prop)) {\n                    if (!root[prop]) {\n                        root[prop] = [];\n                    }\n                    var index = SpriteSheet.preLoad(images[prop], root[prop]);\n                    if (index !== null) {\n                        root[prop] = index;\n                    }\n                }\n            }\n            console.log(root);\n            return root;\n        }\n    }\n\n    function updateSpritesheetEvent(event) {\n        var canvas = event.currentTarget;\n        var url = canvas.getAttribute(\"url\");\n        var slot = slots[url];\n        var spritesheet = getCanvas(\"tex-\" + slot.tex, true);\n        spritesheet.getContext(\"2d\").drawImage(canvas, slot.x, slot.y);\n        spritesheet.dispatchEvent(customEvent(\"update\"));\n    }\n\n    function updateTextureEvent(event) {\n        var canvas = event.currentTarget;\n        textures[parseInt(canvas.getAttribute(\"texture\"))].needsUpdate = true;\n    }\n\n    function destroyEverything() {\n        textures.forEach(function (tex) {\n            if (tex) tex.dispose();\n        });\n        canvases = {};\n        cuts = {};\n        slots = {};\n        textures = [null];\n    }\n\n    function getTextures() {\n        return textures;\n    }\n\n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    function SpriteSheet() {}\n\n    SpriteSheet.getCut = getCut;\n    SpriteSheet.getTextures = getTextures;\n    SpriteSheet.preLoad = preLoad;\n    SpriteSheet.fetchCanvas = fetchCanvas;\n    SpriteSheet.spritesheet = {};\n\n    Utils.onDestroy(destroyEverything);\n\n    return SpriteSheet;\n});\n//# sourceMappingURL=spritesheet.js.map;\n\n\ndefine('turbosort',[],function () {\n\n    var buckets;\n    var counts;\n    var SIZE = 1000;\n    var indexFunction;\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */\n    function initArray(size) {\n        if (!buckets) {\n            buckets = new Uint32Array(size + 1);\n            counts = new Uint32Array(size + 1);\n        }\n    }\n\n    function getMinMax(array, offset, length) {\n        var firstIndex = indexFunction(array[offset]);\n        var minNum = firstIndex;\n        var maxNum = firstIndex;\n        var previousNum = firstIndex;\n        var inOrder = true;\n        for (var i = 1; i < length; i++) {\n            var index = indexFunction(array[offset + i]);\n            if (previousNum > index) {\n                inOrder = false;\n                if (index < minNum) {\n                    minNum = index;\n                }\n            } else {\n                if (index > maxNum) {\n                    maxNum = index;\n                }\n            }\n            previousNum = index;\n        }\n        getMinMax.result.min = minNum;\n        getMinMax.result.max = maxNum;\n        getMinMax.result.inOrder = inOrder;\n        return getMinMax.result;\n    }\n    getMinMax.result = {\n        min: 0,\n        max: 0,\n        inOrder: false\n    };\n\n    function identity(a) {\n        return a;\n    }\n\n    function turboSort(array, size, func) {\n        if (array) {\n            size = size ? Math.min(size, array.length) : array.length;\n            if (size > 1) {\n                indexFunction = func ? func : identity;\n                turboSortHelper(array, 0, size ? size : array.length);\n            }\n        }\n    }\n\n    function quickSort(array, size) {\n        quickSortHelper(array, 0, size ? size - 1 : array.length - 1, compareIndex);\n    }\n\n    function compareIndex(a, b) {\n        return indexFunction(a) - indexFunction(b);\n    }\n\n    function turboSortHelper(array, offset, length) {\n        if (length < 500) {\n            quickSortHelper(array, offset, offset + length - 1, compareIndex);\n            return;\n        }\n        var arrayInfo = getMinMax(array, offset, length);\n        if (arrayInfo.inOrder) {\n            return;\n        }\n        var min = arrayInfo.min;\n        var max = arrayInfo.max;\n        var range = max - min;\n        if (range === 0) {\n            return;\n        }\n\n        var i, index;\n        counts.fill(0);\n        counts[SIZE] = 1;\n        for (i = 0; i < length; i++) {\n            index = Math.floor((SIZE - 1) * (indexFunction(array[i + offset]) - min) / range);\n            counts[index]++;\n        }\n\n        buckets.fill(0);\n        buckets[SIZE] = length;\n        buckets[0] = offset;\n        for (i = 1; i < SIZE; i++) {\n            buckets[i] = buckets[i - 1] + counts[i - 1];\n        }\n\n        var voyager = offset,\n            bucketId = 0;\n        while (bucketId < SIZE) {\n            index = Math.floor((SIZE - 1) * (indexFunction(array[voyager]) - min) / range);\n            var newSpot = buckets[index] + --counts[index];\n            swap(array, voyager, newSpot);\n            while (!counts[bucketId]) {\n                bucketId++;\n            }\n            voyager = buckets[bucketId];\n        }\n        for (i = 0; i < SIZE; i++) {\n            counts[i] = buckets[i + 1] - buckets[i];\n        }\n        for (i = 0; i < SIZE; i++) {\n            if (counts[i] > 1) {\n                turboSortHelper(array, buckets[i], counts[i]);\n            }\n        }\n    }\n\n    function swap(array, a, b) {\n        if (a !== b) {\n            var temp = array[a];\n            array[a] = array[b];\n            array[b] = temp;\n        }\n    }\n\n    function quickSortHelper(arr, left, right, compare) {\n        var len = arr.length,\n            pivot,\n            partitionIndex;\n\n        if (left < right) {\n            pivot = right;\n            partitionIndex = partition(arr, pivot, left, right, compare);\n\n            //sort left and right\n            quickSortHelper(arr, left, partitionIndex - 1, compare);\n            quickSortHelper(arr, partitionIndex + 1, right, compare);\n        }\n        return arr;\n    }\n\n    function partition(arr, pivot, left, right, compare) {\n        var pivotValue = arr[pivot],\n            partitionIndex = left;\n\n        for (var i = left; i < right; i++) {\n            if (compare(arr[i], pivotValue) < 0) {\n                swap(arr, i, partitionIndex);\n                partitionIndex++;\n            }\n        }\n        swap(arr, right, partitionIndex);\n        return partitionIndex;\n    }\n\n    /**\n     *   PROCESSES\n     */\n    initArray(SIZE);\n\n    return turboSort;\n});\n//# sourceMappingURL=turbosort.js.map;\n\n\ndefine('shaders/fragment-shader.glsl',[],function () {\n    return \"\\n    \\nuniform sampler2D texture[ 16 ];\\nvarying vec2 vUv;\\nvarying float vTex;\\nvarying float vLight;\\n\\nvoid main() {\\n    vec2 uv = vUv;\\n\\n    int iTex = int(vTex);\\n\\n    if(iTex==0) {\\n        gl_FragColor = texture2D( texture[0],  uv);\\n    } else if(iTex==1) {\\n        gl_FragColor = texture2D( texture[1],  uv);\\n    } else if(iTex==2) {\\n        gl_FragColor = texture2D( texture[2],  uv);\\n    } else if(iTex==3) {\\n        gl_FragColor = texture2D( texture[3],  uv);\\n    } else if(iTex==4) {\\n        gl_FragColor = texture2D( texture[4],  uv);\\n    } else if(iTex==5) {\\n        gl_FragColor = texture2D( texture[5],  uv);\\n    } else if(iTex==6) {\\n        gl_FragColor = texture2D( texture[6],  uv);\\n    } else if(iTex==7) {\\n        gl_FragColor = texture2D( texture[7],  uv);\\n    } else if(iTex==8) {\\n        gl_FragColor = texture2D( texture[8],  uv);\\n    } else if(iTex==9) {\\n        gl_FragColor = texture2D( texture[9],  uv);\\n    } else if(iTex==10) {\\n        gl_FragColor = texture2D( texture[10],  uv);\\n    } else if(iTex==11) {\\n        gl_FragColor = texture2D( texture[11],  uv);\\n    } else if(iTex==12) {\\n        gl_FragColor = texture2D( texture[12],  uv);\\n    } else if(iTex==13) {\\n        gl_FragColor = texture2D( texture[13],  uv);\\n    } else if(iTex==14) {\\n        gl_FragColor = texture2D( texture[14],  uv);\\n    } else if(iTex==15) {\\n        gl_FragColor = texture2D( texture[15],  uv);\\n    }\\n\\n    gl_FragColor.x *= vLight;\\n    gl_FragColor.y *= vLight;\\n    gl_FragColor.z *= vLight;\\n//        gl_FragColor.w *= vLight;\\n//    gl_FragColor.w = .5;\\n}\\n\\n    \";\n});\n//# sourceMappingURL=fragment-shader.glsl.js.map;\n\n\ndefine('shaders/vertex-shader.glsl',[],function () {\n    return \"\\n    \\nvarying vec2 vUv;\\nattribute float tex;\\nattribute float light;\\nattribute vec3 spot;\\nattribute vec4 quaternion;\\nvarying float vTex;\\nvarying float vLight;\\nuniform vec3 vCam;\\nuniform float curvature;\\n\\nvoid main()  {\\n    vTex = tex;\\n    vUv = uv;\\n\\n    vec3 newPosition = rotateVectorByQuaternion( position - spot, quaternion ) + spot;\\n    vLight = 1.0/ sqrt(500.0 / distance(newPosition, vCam)) * light;\\n\\n    float dist = distance(newPosition, vCam);\\n    newPosition.z = newPosition.z - curvature * (dist*dist)/20000.0;\\n\\n    vec4 mvPosition = modelViewMatrix * vec4(newPosition, 1.0 );\\n    gl_Position = projectionMatrix * mvPosition;\\n}    \\n\\n    \";\n});\n//# sourceMappingURL=vertex-shader.glsl.js.map;\n\n\ndefine('shaders/vertex-shader-common.glsl',[],function () {\n    return \"\\n\\nvec3 rotateVectorByQuaternion( in vec3 v, in vec4 q ) {\\n\\n    vec3 dest = vec3( 0.0 );\\n\\n    float x = v.x, y  = v.y, z  = v.z;\\n    float qx = q.x, qy = q.y, qz = q.z, qw = q.w;\\n\\n    // calculate quaternion * vector\\n\\n    float ix =  qw * x + qy * z - qz * y,\\n          iy =  qw * y + qz * x - qx * z,\\n          iz =  qw * z + qx * y - qy * x,\\n          iw = -qx * x - qy * y - qz * z;\\n\\n    // calculate result * inverse quaternion\\n\\n    dest.x = ix * qw + iw * -qx + iy * -qz - iz * -qy;\\n    dest.y = iy * qw + iw * -qy + iz * -qx - ix * -qz;\\n    dest.z = iz * qw + iw * -qz + ix * -qy - iy * -qx;\\n\\n    return dest;\\n\\n}\\n\\nvec4 axisAngleToQuaternion( in vec3 axis, in float angle ) {\\n\\n    vec4 dest = vec4( 0.0 );\\n\\n    float halfAngle = angle / 2.0,\\n          s = sin( halfAngle );\\n\\n    dest.x = axis.x * s;\\n    dest.y = axis.y * s;\\n    dest.z = axis.z * s;\\n    dest.w = cos( halfAngle );\\n\\n    return dest;\\n\\n}    \\n    \\n    \";\n});\n//# sourceMappingURL=vertex-shader-common.glsl.js.map;\n\n\ndefine('shader',['shaders/fragment-shader.glsl', 'shaders/vertex-shader.glsl', 'shaders/vertex-shader-common.glsl'], function (fragmentShader, vertexShader, vertexShaderCommon) {\n    return {\n        fragmentShader: fragmentShader,\n        vertexShader: vertexShaderCommon + vertexShader\n    };\n});\n//# sourceMappingURL=shader.js.map;\n\n\ndefine('spriterenderer',['threejs', 'utils', 'spriteobject', 'spritesheet', 'objectpool', 'camera', 'turbosort', 'shader'], function (THREE, Utils, SpriteObject, SpriteSheet, ObjectPool, Camera, turboSort, Shader) {\n    'use strict';\n\n    var planeGeometry = new THREE.PlaneBufferGeometry(1, 1);\n    var pointCount = planeGeometry.attributes.position.count;\n    var indices = planeGeometry.index.array;\n    var spriteRenderers = [];\n    var uniforms = null;\n    var indexProcessor = function indexProcessor() {};\n\n    /**\n     *  CLASS DEFINITIONS\n     */\n\n    function SpriteRenderer() {\n        this.images = [];\n        this.imageOrder = [];\n        this.imageCount = 0;\n        this.mesh = createMesh(this);\n        this.curvature = 0;\n\n        var self = this;\n\n        this.display = function (spriteObject) {\n            var image = null;\n            var cut = spriteObject && spriteObject.visible !== false ? SpriteSheet.getCut(spriteObject.img) : null;\n            if (cut && cut.ready) {\n                var index = self.imageCount;\n                if (!self.images[index]) {\n                    self.images[index] = new SpriteImage();\n                    self.images[index].index = index;\n                }\n\n                image = self.images[index];\n\n                for (var j = 0; j < indices.length; j++) {\n                    image.indexArray[j] = indices[j] + image.index * 4;\n                }\n\n                var quat = spriteObject.hasQuaternionArray ? spriteObject.quaternionArray : Camera.getCameraQuaternionData().array;\n                if (image.quaternionArray[0] !== quat[0] || image.quaternionArray[1] !== quat[1] || image.quaternionArray[2] !== quat[2] || image.quaternionArray[3] !== quat[3]) {\n                    image.quaternionArray.set(quat);\n                    image.quaternionArray.set(quat, 4);\n                    image.quaternionArray.set(quat, 8);\n                    image.quaternionArray.set(quat, 12);\n                    image.quatDirty = true;\n                }\n\n                if (!spriteObject.position.equals(image.position)) {\n                    image.position.copy(spriteObject.position);\n                    image.position.toArray(image.spotArray);\n                    image.position.toArray(image.spotArray, 3);\n                    image.position.toArray(image.spotArray, 6);\n                    image.position.toArray(image.spotArray, 9);\n                    image.positionDirty = true;\n                }\n\n                if (spriteObject.size[0] !== image.size[0] || spriteObject.size[1] !== image.size[1] || spriteObject.size[2] !== image.size[2] || image.positionDirty) {\n                    image.size[0] = spriteObject.size[0];\n                    image.size[1] = spriteObject.size[1];\n                    image.size[2] = spriteObject.size[2];\n                    var vertices = planeGeometry.attributes.position.array;\n                    for (var v = 0; v < vertices.length; v++) {\n                        image.vertices[v] = vertices[v] * spriteObject.size[v % 3] + image.spotArray[v];\n                    }\n                    image.verticesDirty = true;\n                }\n\n                if (image.uv !== cut.uv) {\n                    image.uv = cut.uv;\n                    image.uvDirty = true;\n                }\n\n                if (image.tex !== cut.tex) {\n                    image.tex = cut.tex;\n                    image.texDirty = true;\n                }\n\n                if (image.light !== spriteObject.light) {\n                    image.light = spriteObject.light;\n                    image.lightDirty = true;\n                }\n                image.spriteObject = spriteObject;\n                self.imageOrder[index] = image;\n                self.imageCount++;\n            }\n            return image;\n        };\n\n        spriteRenderers.push(this);\n    }\n\n    SpriteRenderer.prototype.destroy = destroySprite;\n    SpriteRenderer.prototype.render = render;\n    SpriteRenderer.prototype.updateGraphics = updateGraphics;\n    SpriteRenderer.prototype.clear = clear;\n\n    function SpriteImage() {\n        this.position = new THREE.Vector3();\n        this.spotArray = new Float32Array(3 * pointCount);\n        this.size = new Float32Array(3);\n        this.vertices = new Float32Array(planeGeometry.attributes.position.array.length);\n        this.quaternionArray = new Float32Array(4 * pointCount);\n        this.indexArray = new Uint16Array(indices.length);\n    }\n    SpriteImage.prototype.index = 0;\n    SpriteImage.prototype.position = null;\n    SpriteImage.prototype.spotArray = null;\n    SpriteImage.prototype.indexArray = null;\n    SpriteImage.prototype.tex = -1;\n    SpriteImage.prototype.size = null;\n    SpriteImage.prototype.uv = null;\n    SpriteImage.prototype.vertices = null;\n    SpriteImage.prototype.light = 1;\n    SpriteImage.prototype.zIndex = 0;\n    SpriteImage.prototype.quaternionArray = null;\n    SpriteImage.prototype.positionDirty = true;\n    SpriteImage.prototype.verticesDirty = true;\n    SpriteImage.prototype.texDirty = true;\n    SpriteImage.prototype.uvDirty = true;\n    SpriteImage.prototype.lightDirty = true;\n    SpriteImage.prototype.quatDirty = true;\n    SpriteImage.prototype.spriteObject = null;\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */\n\n    function clear() {\n        this.imageCount = 0;\n        ObjectPool.recycleAll(SpriteObject);\n    }\n\n    function createMesh(spriteRenderer) {\n        var geometry = new THREE.BufferGeometry();\n        var vertices = new Float32Array([-1.0, -1.0, 1.0, 1.0, -1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0, 1.0, 1.0, -1.0, -1.0, 1.0]);\n        geometry.addAttribute('position', new THREE.BufferAttribute(vertices, 3));\n        var mesh = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial());\n\n        mesh.material = new THREE.ShaderMaterial({\n            uniforms: uniforms = {\n                texture: {\n                    type: 'tv',\n                    get value() {\n                        return SpriteSheet.getTextures();\n                    }\n                },\n                vCam: {\n                    type: \"v3\",\n                    get value() {\n                        return Camera.getCamera().position;\n                    }\n                },\n                curvature: {\n                    type: \"f\",\n                    get value() {\n                        return spriteRenderer.curvature || 0;\n                    }\n                }\n            },\n            vertexShader: Shader.vertexShader,\n            fragmentShader: Shader.fragmentShader,\n            transparent: true,\n            depthWrite: false,\n            depthTest: true\n        });\n\n        mesh.frustumCulled = false;\n        return mesh;\n    }\n\n    function sortImages(images, count) {\n        var camera = Camera.getCamera();\n        for (var i = 0; i < count; i++) {\n            images[i].zIndex = -camera.position.distanceToManhattan(images[i].position);\n        }\n        indexProcessor(images, count);\n        turboSort(images, count, indexFunction);\n    }\n\n    function setIndexProcessor(fun) {\n        indexProcessor = fun ? fun : function () {};\n    }\n\n    function indexFunction(a) {\n        return a.zIndex;\n    }\n\n    function render() {\n        var imageCount = this.imageCount;\n        var pointCount = planeGeometry.attributes.position.count;\n        var previousAttribute;\n\n        var mesh = this.mesh;\n        var geometry = mesh.geometry;\n        if (!geometry.attributes.position || geometry.attributes.position.count < imageCount * pointCount) {\n            previousAttribute = geometry.attributes.position;\n            geometry.attributes.position = new THREE.BufferAttribute(new Float32Array(imageCount * pointCount * 3), 3);\n            if (previousAttribute) geometry.attributes.position.copyArray(previousAttribute.array);\n            geometry.attributes.position.setDynamic(true);\n        }\n        if (!geometry.attributes.spot || geometry.attributes.spot.count < imageCount * pointCount) {\n            previousAttribute = geometry.attributes.spot;\n            geometry.attributes.spot = new THREE.BufferAttribute(new Float32Array(imageCount * pointCount * 3), 3);\n            if (previousAttribute) geometry.attributes.spot.copyArray(previousAttribute.array);\n            geometry.attributes.spot.setDynamic(true);\n        }\n        if (!geometry.attributes.quaternion || geometry.attributes.quaternion.count < imageCount * pointCount) {\n            previousAttribute = geometry.attributes.quaternion;\n            geometry.attributes.quaternion = new THREE.BufferAttribute(new Float32Array(imageCount * pointCount * 4), 4);\n            if (previousAttribute) geometry.attributes.quaternion.copyArray(previousAttribute.array);\n            geometry.attributes.quaternion.setDynamic(true);\n        }\n        if (!geometry.attributes.uv || geometry.attributes.uv.count < imageCount * pointCount) {\n            previousAttribute = geometry.attributes.uv;\n            geometry.attributes.uv = new THREE.BufferAttribute(new Float32Array(imageCount * pointCount * 2), 2);\n            if (previousAttribute) geometry.attributes.uv.copyArray(previousAttribute.array);\n            geometry.attributes.uv.setDynamic(true);\n        }\n        if (!geometry.attributes.tex || geometry.attributes.tex.count < imageCount * pointCount) {\n            previousAttribute = geometry.attributes.tex;\n            geometry.attributes.tex = new THREE.BufferAttribute(new Float32Array(imageCount * pointCount), 1);\n            if (previousAttribute) geometry.attributes.tex.copyArray(previousAttribute.array);\n            geometry.attributes.tex.setDynamic(true);\n        }\n        if (!geometry.attributes.light || geometry.attributes.light.count < imageCount * pointCount) {\n            previousAttribute = geometry.attributes.light;\n            geometry.attributes.light = new THREE.BufferAttribute(new Float32Array(imageCount * pointCount), 1);\n            if (previousAttribute) geometry.attributes.light.copyArray(previousAttribute.array);\n            geometry.attributes.light.setDynamic(true);\n        }\n        if (!geometry.index || geometry.index.count < imageCount * planeGeometry.index.array.length) {\n            previousAttribute = geometry.index;\n            var indices = planeGeometry.index.array;\n            geometry.index = new THREE.BufferAttribute(new Uint16Array(imageCount * indices.length), 1);\n            if (previousAttribute) geometry.index.copyArray(previousAttribute.array);\n            geometry.index.setDynamic(true);\n        }\n\n        sortImages(this.imageOrder, imageCount);\n    }\n\n    function updateGraphics() {\n        this.render();\n\n        var images = this.images;\n        var imageOrder = this.imageOrder;\n        var imageCount = this.imageCount;\n        var geometry = this.mesh.geometry;\n        var geo_quaternion = geometry.attributes.quaternion.array;\n        var geo_spot = geometry.attributes.spot.array;\n        var geo_pos = geometry.attributes.position.array;\n        var geo_tex = geometry.attributes.tex.array;\n        var geo_light = geometry.attributes.light.array;\n        var geo_uv = geometry.attributes.uv.array;\n        var geo_index = geometry.index.array;\n\n        var quatChanged = false;\n        var positionChanged = false;\n        var texChanged = false;\n        var verticesChanged = false;\n        var uvChanged = false;\n        var lightChanged = false;\n\n        for (var i = 0; i < imageCount; i++) {\n            var image = images[i];\n            var index = image.index;\n\n            if (image.quatDirty) {\n                var quaternionArray = image.quaternionArray;\n                geo_quaternion.set(quaternionArray, index * 16);\n                image.quatDirty = false;\n                quatChanged = true;\n            }\n\n            if (image.positionDirty) {\n                geo_spot.set(image.spotArray, index * 12);\n                image.positionDirty = false;\n                positionChanged = true;\n            }\n\n            if (image.verticesDirty) {\n                geo_pos.set(image.vertices, index * 12);\n                image.verticesDirty = false;\n                verticesChanged = true;\n            }\n\n            if (image.uvDirty) {\n                geo_uv.set(image.uv, index * 8);\n                image.uvDirty = false;\n                uvChanged = true;\n            }\n\n            if (image.texDirty) {\n                geo_tex.fill(image.tex, index * 4, index * 4 + 4);\n                image.texDirty = false;\n                texChanged = true;\n            }\n\n            if (image.lightDirty) {\n                geo_light.fill(image.light, index * 4, index * 4 + 4);\n                image.lightDirty = false;\n                lightChanged = true;\n            }\n        }\n\n        for (i = 0; i < imageCount; i++) {\n            geo_index.set(imageOrder[i].indexArray, i * 6);\n        }\n\n        if (geometry.drawRange.start !== 0 || geometry.drawRange.count !== imageCount * planeGeometry.index.count) {\n            geometry.setDrawRange(0, imageCount * planeGeometry.index.count);\n        }\n\n        if (lightChanged) {\n            geometry.attributes.light.needsUpdate = true;\n        }\n        if (quatChanged) {\n            geometry.attributes.quaternion.needsUpdate = true;\n        }\n        if (positionChanged) {\n            geometry.attributes.spot.needsUpdate = true;\n        }\n        if (verticesChanged) {\n            geometry.attributes.position.needsUpdate = true;\n        }\n        if (texChanged) {\n            geometry.attributes.tex.needsUpdate = true;\n        }\n        if (uvChanged) {\n            geometry.attributes.uv.needsUpdate = true;\n        }\n        geometry.index.needsUpdate = true;\n        this.clear();\n    }\n\n    function destroyEverything() {\n        for (var i = 0; i < spriteRenderers.length; i++) {\n            spriteRenderers[i].destroy();\n        }\n        spriteRenderers.length = 0;\n    }\n\n    function destroySprite() {\n        if (this.mesh) {\n            this.mesh.geometry.dispose();\n            this.mesh.material.dispose();\n        }\n        this.mesh = null;\n        this.images.length = 0;\n        this.imageCount = 0;\n    }\n\n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    SpriteRenderer.setIndexProcessor = setIndexProcessor;\n    Utils.onDestroy(destroyEverything);\n\n    /**\n     *   PROCESSES\n     */\n\n    return SpriteRenderer;\n});\n//# sourceMappingURL=spriterenderer.js.map;\n\n\ndefine('collection',['utils', 'spritesheet', 'spriteobject', 'camera'], function (Utils, SpriteSheet, SpriteObject, Camera) {\n\n    'use strict';\n\n    function nop() {}\n\n    function Collection(options, getSpriteFunction, forEach) {\n        this.options = options || {};\n        this.getSprite = getSpriteFunction ? getSpriteFunction : nop;\n        if (forEach) {\n            this.forEach = forEach.bind(this);\n        } else {\n            switch (this.options.type) {\n                case \"grid\":\n                    this.forEach = Grid_forEach.bind(this);\n                    break;\n                default:\n                    Utils.handleError('Collection type not recognized');\n                    break;\n            }\n        }\n    }\n    Collection.prototype.pos = null;\n    Collection.prototype.size = null;\n    Collection.prototype.getSprite = nop;\n    Collection.prototype.forEach = nop;\n    Collection.prototype.options = null;\n    Collection.prototype.getSprite = nop;\n    Collection.prototype.isCollection = true;\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */\n    function Grid_forEach(callback) {\n        var count = this.options.count || 1;\n        var gridCount = this.options.width * this.options.height;\n        var length = gridCount * count;\n        for (var i = 0; i < length; i++) {\n            var x = this.options.x + i % this.options.width;\n            var y = this.options.y + Math.floor(i / this.options.width) % this.options.height;\n            var c = Math.floor(i / gridCount);\n            var obj = this.getSprite(x, y, c);\n            if (obj) {\n                if (obj.forEach) {\n                    obj.forEach(callback);\n                } else {\n                    callback(obj);\n                }\n            }\n        }\n    }\n\n    function destroyEverything() {}\n\n    function spriteFace(spriteInfo) {\n        var x = spriteInfo.x;\n        var y = spriteInfo.y;\n        var index = spriteInfo.index;\n        var size = cellSize;\n        var light = 1;\n        var img = SpriteSheet.spritesheet.sprite[index];\n\n        return SpriteObject.create().init(x * cellSize, y * cellSize, size / 2, size, size, null, light, img);\n    }\n\n    var cubeFaces = [];\n    function spriteCube(spriteInfo) {\n        cubeFaces.length = 0;\n\n        cube.faces.push(SpriteObject.create().init(x * cellSize, y * cellSize, size / 2, size, size, Camera.quaternions.southQuaternionArray, light, img));\n\n        return cubeFaces;\n    }\n\n    function createSpriteCollection(options) {\n        var spriteMap = [];\n        var areaSize = 50;\n        var spriteRegistry = {};\n        var cellSize = 64;\n\n        var spriteFunction = function spriteFunction(spriteInfo) {\n            switch (spriteInfo.type) {\n                case 'face':\n                    return spriteFace(spriteInfo);\n                    break;\n                case 'cube':\n                    return spriteCube(spriteInfo);\n                    break;\n            }\n        };\n        if (options.spriteFunction) {\n            spriteFunction = options.spriteFunction;\n        }\n\n        var spriteCount = 0;\n        function SpriteInfo(x, y, index) {\n            this.uid = 'uid' + spriteCount++;\n            spriteRegistry[this.uid] = this;\n            this.index = index;\n            this.enterArea(x, y);\n        }\n        SpriteInfo.prototype.leaveArea = function () {\n            var areaId = getAreaId(this.x, this.y);\n            var area = spriteMap[areaId];\n            if (area) {\n                var posId = Math.floor(this.x) + \"_\" + Math.floor(this.y);\n                if (area[posId]) delete area[posId][this.uid];\n            }\n        };\n        SpriteInfo.prototype.enterArea = function (x, y) {\n            this.x = x;this.y = y;\n            var areaId = getAreaId(this.x, this.y);\n            var area = spriteMap[areaId] || (spriteMap[areaId] = {});\n            var posId = Math.floor(this.x) + \"_\" + Math.floor(this.y);\n            area[posId] = area[posId] || (area[posId] = {});\n            area[posId][this.uid] = this;\n        };\n        SpriteInfo.prototype.move = function (x, y) {\n            this.leaveArea();\n            this.enterArea(x, y);\n        };\n\n        function getAreaId(x, y) {\n            x = Math.floor(x / areaSize);\n            y = Math.floor(y / areaSize);\n            return x + \"_\" + y;\n        }\n\n        var selectedObj = { x: 0, y: 0 };\n        function getCamPos() {\n            var cellSize = 64;\n            var camera = Camera.getCamera();\n            var xPos = camera.position.x;\n            var yPos = camera.position.y;\n\n            selectedObj.x = Math.round(xPos / cellSize);\n            selectedObj.y = Math.round(yPos / cellSize) + 6;\n            return selectedObj;\n        }\n\n        var spriteCollection = new Collection(options, spriteFunction, function (callback) {\n            var camPos = getCamPos();\n            var xArea = Math.floor(camPos.x / areaSize);\n            var yArea = Math.floor(camPos.y / areaSize);\n            var range = 1;\n            for (var y = yArea - range; y <= yArea + range; y++) {\n                for (var x = xArea - range; x <= xArea + range; x++) {\n                    var area = spriteMap[x + \"_\" + y];\n                    if (area) {\n                        for (var a in area) {\n                            var sprites = area[a];\n                            for (var s in sprites) {\n                                var obj = this.getSprite(sprites[s]);\n                                if (Array.isArray(obj)) {\n                                    obj.forEach(callback);\n                                } else {\n                                    callback(obj);\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        });\n        spriteCollection.create = function (x, y, index) {\n            return new SpriteInfo(x, y, index);\n        };\n\n        spriteCollection.get = function (x, y) {\n            var areaId = getAreaId(x, y);\n            var area = spriteMap[areaId];\n            var posId = Math.floor(x) + \"_\" + Math.floor(y);\n            return area ? area[posId] : null;\n        };\n        spriteCollection.find = function (uid) {\n            return spriteRegistry[uid];\n        };\n        return spriteCollection;\n    }\n\n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    Collection.createSpriteCollection = createSpriteCollection;\n\n    /**\n     *   PROCESSES\n     */\n    Utils.onDestroy(destroyEverything);\n\n    return Collection;\n});\n//# sourceMappingURL=collection.js.map;\n\n\ndefine('mouse',['utils'], function (Utils) {\n\n    'use strict';\n\n    var spot = { x: 0, y: 0 },\n        callbacks = [];\n    var touchSpotX = {},\n        touchSpotY = {};\n    var mdown = false;\n\n    /**\n     *  FUNCTION DEFINITIONS\n     */\n    function onDown(e) {\n        if (e.target.attributes['tap'] === undefined) {\n            var touches = e.changedTouches;\n            if (touches) {\n                for (var i = 0; i < touches.length; i++) {\n                    var touch = touches[i];\n                    touchSpotX[touch.identifier] = touch.pageX;\n                    touchSpotY[touch.identifier] = touch.pageY;\n                }\n            } else {\n                spot.x = e.pageX;\n                spot.y = e.pageY;\n            }\n            mdown = true;\n            for (var i = 0; i < callbacks.length; i++) {\n                callbacks[i](null, null, true, e.pageX, e.pageY);\n            }\n        }\n        e.preventDefault();\n    }\n\n    function onUp(e) {\n\n        var hasTouch = false;\n        if (e.changedTouches) {\n            for (var i = 0; i < e.changedTouches.length; i++) {\n                delete touchSpotX[touch.identifier];\n                delete touchSpotY[touch.identifier];\n            }\n            for (var i in touchSpotX) {\n                hasTouch = true;\n            }\n        }\n\n        for (var i = 0; i < callbacks.length; i++) {\n            callbacks[i](null, null, hasTouch, e.pageX, e.pageY);\n        }\n        mdown = false;\n        e.preventDefault();\n    }\n\n    function onMove(e) {\n        e = e || event;\n        var touches = e.changedTouches;\n        if (!touches) {\n            var buttonDown = 'buttons' in e && e.buttons === 1 || (e.which || e.button) === 1;\n\n            if (buttonDown && mdown) {\n                var newX = e.pageX;\n                var newY = e.pageY;\n                var dx = newX - spot.x;\n                var dy = newY - spot.y;\n                spot.x = newX;\n                spot.y = newY;\n                for (var i = 0; i < callbacks.length; i++) {\n                    callbacks[i](dx, dy, true, e.pageX, e.pageY);\n                }\n            } else {\n                mdown = false;\n                for (var i = 0; i < callbacks.length; i++) {\n                    callbacks[i](dx, dy, false, e.pageX, e.pageY);\n                }\n            }\n        } else if (mdown) {\n            var dx = 0,\n                dy = 0;\n            for (var i = 0; i < touches.length; i++) {\n                var touch = touches[i];\n                dx += touch.pageX - touchSpotX[touch.identifier];\n                dy += touch.pageY - touchSpotY[touch.identifier];\n                touchSpotX[touch.identifier] = touch.pageX;\n                touchSpotY[touch.identifier] = touch.pageY;\n            }\n            for (var i = 0; i < callbacks.length; i++) {\n                callbacks[i](dx, dy, true, e.pageX, e.pageY);\n            }\n        }\n        e.preventDefault();\n    }\n\n    function setOnTouch(func) {\n        deactivateTouch();\n        activateTouch();\n        callbacks.push(func);\n    }\n\n    function activateTouch() {\n\n        document.addEventListener(\"mousedown\", onDown);\n        document.addEventListener(\"touchstart\", onDown);\n        document.addEventListener(\"mouseup\", onUp);\n        document.addEventListener(\"touchend\", onUp);\n        document.addEventListener(\"touchcancel\", onUp);\n        document.addEventListener(\"mousemove\", onMove);\n        document.addEventListener(\"touchmove\", onMove);\n    }\n\n    function deactivateTouch() {\n        document.removeEventListener(\"mousedown\", onDown);\n        document.removeEventListener(\"touchstart\", onDown);\n        document.removeEventListener(\"mouseup\", onUp);\n        document.removeEventListener(\"touchend\", onUp);\n        document.removeEventListener(\"touchcancel\", onUp);\n        document.removeEventListener(\"mousemove\", onMove);\n        document.removeEventListener(\"touchmove\", onMove);\n    }\n\n    function destroyEverything() {\n        callbacks = [];\n        deactivateTouch();\n    }\n\n    /**\n     *  PUBLIC DECLARATIONS\n     */\n    function Mouse() {}\n    Mouse.setOnTouch = setOnTouch;\n\n    Utils.onDestroy(destroyEverything);\n\n    return Mouse;\n});\n//# sourceMappingURL=mouse.js.map;\n\n\ndefine('dobuki',['utils', 'loop', 'gifHandler', 'camera', 'objectpool', 'spriteobject', 'packer', 'spritesheet', 'spriterenderer', 'collection', 'mouse', 'loader'], function (Utils, Loop, GifHandler, Camera, ObjectPool, SpriteObject, Packer, SpriteSheet, SpriteRenderer, Collection, Mouse, Loader) {\n\n    return {\n        Utils: Utils,\n        Loop: Loop,\n        GifHandler: GifHandler,\n        Camera: Camera,\n        ObjectPool: ObjectPool,\n        SpriteObject: SpriteObject,\n        SpriteSheet: SpriteSheet,\n        SpriteRenderer: SpriteRenderer,\n        Collection: Collection,\n        Mouse: Mouse,\n        Loader: Loader\n    };\n});\n//# sourceMappingURL=dobuki.js.map;\n\n\nrequirejs.config({\n    paths: {\n        threejs: 'https://cdnjs.cloudflare.com/ajax/libs/three.js/85/three.min',\n        dobuki: 'dobuki',\n        jsgif: 'jsgif/gif'\n    },\n    urlArgs: location.search.match(/\\bdebug\\b|\\bdisable_cache\\b/g) ? \"time=\" + Date.now() : ''\n});\n\nrequire([\"dobuki\"], function (DOK) {});\n//# sourceMappingURL=main.js.map;\ndefine(\"main\", function(){});\n\n"]}