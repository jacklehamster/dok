{"version":3,"sources":["../../workers/gifworker.js"],"names":["onmessage","e","frameInfo","data","cData","header","id","plasterPixels","postMessage","buffer","img","gce","transparency","transparencyGiven","transparencyIndex","disposalMethod","ct","lctFlag","lct","gct","pixels","forEach","pixel","i"],"mappings":";;AAAAA,YAAY,mBAASC,CAAT,EAAY;AACpB,QAAIC,YAAYD,EAAEE,IAAF,CAAOD,SAAvB;AACA,QAAIE,QAAQH,EAAEE,IAAF,CAAOC,KAAnB;AACA,QAAIC,SAASJ,EAAEE,IAAF,CAAOE,MAApB;AACA,QAAIC,KAAKL,EAAEE,IAAF,CAAOG,EAAhB;;AAEA,QAAGJ,aAAaE,KAAb,IAAsBC,MAAzB,EAAiC;AAC7BE,sBAAcL,SAAd,EAAyBE,KAAzB,EAAgCC,MAAhC;AACH;AACDG,gBAAY,EAACF,IAAGA,EAAJ,EAAQF,OAAOA,KAAf,EAAsBF,WAAWA,SAAjC,EAAZ,EAAyD,CAACE,MAAMD,IAAN,CAAWM,MAAZ,CAAzD;AACH,CAVD;;AAYA,SAASF,aAAT,CAAuBL,SAAvB,EAAkCE,KAAlC,EAAyCC,MAAzC,EAAiD;AAC7C,QAAIK,MAAMR,UAAUQ,GAApB;AACA,QAAIC,MAAMT,UAAUS,GAApB;AACA,QAAIC,eAAeD,IAAIE,iBAAJ,GAAwBF,IAAIG,iBAA5B,GAAgD,IAAnE;AACA,QAAIC,iBAAiBJ,IAAII,cAAzB;;AAEA,QAAIC,KAAKN,IAAIO,OAAJ,GAAcP,IAAIQ,GAAlB,GAAwBb,OAAOc,GAAxC;;AAEAT,QAAIU,MAAJ,CAAWC,OAAX,CAAmB,UAASC,KAAT,EAAgBC,CAAhB,EAAmB;AAClC,YAAIX,iBAAiBU,KAArB,EAA4B;AAAE;AAC1BlB,kBAAMD,IAAN,CAAWoB,IAAI,CAAf,IAAwBP,GAAGM,KAAH,EAAU,CAAV,CAAxB;AACAlB,kBAAMD,IAAN,CAAWoB,IAAI,CAAJ,GAAQ,CAAnB,IAAwBP,GAAGM,KAAH,EAAU,CAAV,CAAxB;AACAlB,kBAAMD,IAAN,CAAWoB,IAAI,CAAJ,GAAQ,CAAnB,IAAwBP,GAAGM,KAAH,EAAU,CAAV,CAAxB;AACAlB,kBAAMD,IAAN,CAAWoB,IAAI,CAAJ,GAAQ,CAAnB,IAAwB,GAAxB,CAJwB,CAIK;AAChC,SALD,MAKO,IAAIR,mBAAmB,CAAnB,IAAwBA,mBAAmB,CAA/C,EAAkD;AACrDX,kBAAMD,IAAN,CAAWoB,IAAI,CAAJ,GAAQ,CAAnB,IAAwB,CAAxB,CADqD,CAC1B;AAC9B;AACJ,KATD;AAUH","file":"gifworker.js","sourcesContent":["onmessage = function(e) {\n    var frameInfo = e.data.frameInfo;\n    var cData = e.data.cData;\n    var header = e.data.header;\n    var id = e.data.id;\n\n    if(frameInfo && cData && header) {\n        plasterPixels(frameInfo, cData, header);\n    }\n    postMessage({id:id, cData: cData, frameInfo: frameInfo },[cData.data.buffer]);\n};\n\nfunction plasterPixels(frameInfo, cData, header) {\n    var img = frameInfo.img;\n    var gce = frameInfo.gce;\n    var transparency = gce.transparencyGiven ? gce.transparencyIndex : null;\n    var disposalMethod = gce.disposalMethod;\n\n    var ct = img.lctFlag ? img.lct : header.gct;\n    \n    img.pixels.forEach(function(pixel, i) {\n        if (transparency !== pixel) { // This includes null, if no transparency was defined.\n            cData.data[i * 4    ] = ct[pixel][0];\n            cData.data[i * 4 + 1] = ct[pixel][1];\n            cData.data[i * 4 + 2] = ct[pixel][2];\n            cData.data[i * 4 + 3] = 255; // Opaque.\n        } else if (disposalMethod === 2 || disposalMethod === 3) {\n            cData.data[i * 4 + 3] = 0; // Transparent.\n        }\n    });\n}\n"]}